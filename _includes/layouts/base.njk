{# ============================================================================
   BASE LAYOUT TEMPLATE
   ============================================================================
   This is the main layout that wraps around all your pages. It includes:
   - The HTML structure (<head>, <body>)
   - The video hero section (homepage only)
   - The collapsible sidebar navigation
   - A content area where page-specific content gets inserted

   HOW IT WORKS:
   When you create a page like about.njk and add 'layout: base.njk' at the top,
   Eleventy wraps your page's content with this template. Your content appears
   where it says {{ content | safe }}.
   ============================================================================ #}
<!DOCTYPE html>
<html lang="en">
<head>
  {# META TAGS: Basic information about your page for browsers and search engines #}
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  {# TITLE: Shows in browser tab. Format: "Page Name | Nick Galinski" #}
  {# The {{ title }} variable comes from the front matter of each page #}
  <title>{{ title }} | Nick Galinski</title>

  {# DESCRIPTION: Shows in search engine results #}
  {# Uses page's description if provided, otherwise uses default text #}
  <meta name="description" content="{{ description | default('Portfolio of Nick Galinski - Content Designer & Writer') }}">

  {# STYLESHEET: Links to your main CSS file #}
  <link rel="stylesheet" href="/assets/css/main.css">
</head>
<body>

  {# ==========================================================================
     VIDEO HERO SECTION (Homepage Only)
     ========================================================================== #}
  {# This only displays if showVideoHero is true (set in index.njk) #}
  {% if showVideoHero %}
  <div class="video-hero">
    {# VIDEO: Vimeo embed with background autoplay #}
    {# The video autoplays, is muted, and loops continuously #}
    <div class="video-hero__video">
      <iframe src="https://player.vimeo.com/video/1154771220?badge=0&autopause=0&player_id=0&app_id=58479&autoplay=1&muted=1&loop=1&background=1" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" style="position:absolute;top:50%;left:50%;width:177.77vh;height:100vh;min-width:100%;min-height:56.25vw;transform:translate(-50%,-50%);" title="Portfolio Trailer"></iframe>
    </div>
    {# OVERLAY: Dark semi-transparent layer over video to improve text readability #}
    <div class="video-hero__overlay"></div>
    {# TEXT CONTENT: Your name and tagline appear over the video #}
    <div class="video-hero__content">
      <h1 class="video-hero__title">Nicholas Galinski</h1>
      <p class="video-hero__subtitle">The Everything Storyteller</p>
    </div>
  </div>
  {% endif %}

  {# ==========================================================================
     MAIN SITE WRAPPER
     ========================================================================== #}
  {# This contains the sidebar and main content area #}
  {# The 'has-video-hero' class is added on homepage to adjust spacing #}
  <div class="site-wrapper {% if showVideoHero %}has-video-hero{% endif %}">

    {# HAMBURGER TOGGLE: Mobile menu button (outside sidebar so it's always visible) #}
    <button class="sidebar__toggle" id="sidebar-toggle" aria-label="Toggle navigation">
      <span class="sidebar__toggle-icon"></span>
    </button>

    {# ========================================================================
       SIDEBAR NAVIGATION
       ======================================================================== #}
    {# The sidebar contains your navigation menu and collapses on mobile #}
    <aside class="sidebar" id="sidebar">
      <div class="sidebar__content">
        {# LOGO/HOME LINK: Your name, links back to homepage #}
        <a href="/" class="sidebar__logo">Nicholas Galinski</a>

        {# NAVIGATION MENU: Built from navigation.xml data #}
        <nav class="sidebar__nav" aria-label="Main navigation">
          {# Short titles for nav menu items #}
          {% set navTitles = {
            'everland-trust-safety': 'In-Game Reporting System',
            'aws-ai-agents': 'AI Agents Marketplace',
            'sacred-grounds-shop': 'Live Game System CX',
            'everland-narrative': 'MMO Narrative Design',
            'sacred-grounds-supernal': 'Immersive Marketing Event',
            'sacred-grounds-influencer': 'Influencer Marketing',
            'building-this-portfolio': 'Building This Portfolio',
            'google-translate-lens': 'Tech Product Documentation',
            'sacred-grounds-rulebook': 'Game Rules',
            'api-documentation': 'API Reference',
            'oathforger-chapter-1': 'Fiction Narrative',
            'short-form': 'Podcast Ad Read Copy'
          } %}
          {# Loop through each top-level section (Case Studies, Individual Samples) #}
          {% for section in navigation.section %}
          <div class="nav-section" data-section-id="{{ section['@_id'] }}">
            {# SECTION HEADER: Split into link (navigates) and button (expands) #}
            <div class="nav-section__header">
              <a href="{{ section['@_landing'] }}" class="nav-section__link" data-landing="{{ section['@_landing'] }}">
                {{ section['@_label'] }}
              </a>
              <button class="nav-section__expand" aria-expanded="false" aria-label="Expand {{ section['@_label'] }}">
                <svg class="nav-section__icon" viewBox="0 0 24 24" width="16" height="16">
                  <path d="M9 18l6-6-6-6" fill="none" stroke="currentColor" stroke-width="2"/>
                </svg>
              </button>
            </div>

            {# SECTION ITEMS: The collapsible content under each section #}
            <ul class="nav-section__items">
              {# Handle array of items #}
              {% if section.item.length %}
                {% for item in section.item %}
                <li>
                  <a href="/projects/{{ item['@_id'] }}/">{{ navTitles[item['@_id']] or item['@_label'] }}</a>
                </li>
                {% endfor %}
              {% else %}
                {# Handle single item (not an array) #}
                <li>
                  <a href="/projects/{{ section.item['@_id'] }}/">{{ navTitles[section.item['@_id']] or section.item['@_label'] }}</a>
                </li>
              {% endif %}
            </ul>
          </div>
          {% endfor %}

          {# STANDALONE PAGES: About, Contact, Resume #}
          {# These appear at the bottom of the sidebar #}
          <ul class="nav-pages">
            {% for page in navigation.pages.page %}
            <li>
              <a href="/{{ page['@_id'] }}/">{{ page['@_label'] }}</a>
            </li>
            {% endfor %}
          </ul>
        </nav>
      </div>

      {# SCROLL INDICATORS: Show "More" when content overflows #}
      <div class="sidebar__scroll-indicator sidebar__scroll-indicator--top" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="12" height="12">
          <path d="M18 15l-6-6-6 6" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
        <span>More</span>
      </div>
      <div class="sidebar__scroll-indicator sidebar__scroll-indicator--bottom" aria-hidden="true">
        <span>More</span>
        <svg viewBox="0 0 24 24" width="12" height="12">
          <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>

      {# COLLAPSE TOGGLE: Desktop only - collapse/expand sidebar #}
      <button class="sidebar__collapse-toggle" id="sidebar-collapse" aria-label="Collapse sidebar">
        <svg viewBox="0 0 24 24" width="16" height="16">
          <path d="M15 18l-6-6 6-6" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </button>
    </aside>

    {# ========================================================================
       MAIN CONTENT AREA
       ======================================================================== #}
    {# This is where your page-specific content gets inserted #}
    {# The {{ content | safe }} variable contains the HTML from your page files #}
    {# The 'safe' filter tells Nunjucks to render the HTML (not escape it) #}
    <main class="main-content" id="main-content">
      {{ content | safe }}
    </main>

    {# ========================================================================
       RIGHT STICKY MENU - Desktop Only
       ======================================================================== #}
    <nav class="right-menu" aria-label="Site pages">
      {# Container 1: Blog #}
      <div class="right-menu__section">
        <a href="/blog/" class="right-menu__header">Everything Storyteller Blog</a>
        {% if posts and posts[0] %}
        <a href="/blog/{{ posts[0].meta.id }}/" class="right-menu__recent-post">
          {{ posts[0].meta.title }}
        </a>
        {% endif %}
      </div>

      {# Container 2: Navigation #}
      <div class="right-menu__section">
        <a href="/about/" class="right-menu__link">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2M12 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"/>
          </svg>
          <span>About</span>
        </a>
        <a href="/resume/" class="right-menu__link">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
            <path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"/>
          </svg>
          <span>Work History</span>
        </a>
        <a href="/contact/" class="right-menu__link">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/>
            <polyline points="22,6 12,13 2,6"/>
          </svg>
          <span>Contact</span>
        </a>
      </div>

      {# Container 3: Socials #}
      <div class="right-menu__section">
        <a href="https://www.linkedin.com/in/nicholas-galinski/" class="right-menu__link right-menu__link--external" target="_blank" rel="noopener">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-4 0v7h-4v-7a6 6 0 0 1 6-6z"/>
            <rect x="2" y="9" width="4" height="12"/>
            <circle cx="4" cy="4" r="2"/>
          </svg>
          <span>LinkedIn</span>
          <svg class="external-icon" viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
            <polyline points="15 3 21 3 21 9"/>
            <line x1="10" y1="14" x2="21" y2="3"/>
          </svg>
        </a>
      </div>
    </nav>

  </div>

  {# JAVASCRIPT: Handles sidebar toggle and collapsible navigation #}
  <script src="/assets/js/main.js"></script>
</body>
</html>